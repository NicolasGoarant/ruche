<%# CSS is now in ruche.css â€” this partial is pure HTML + minimal JS %>
<% active ||= '' %>

<nav class="navbar">
  <a href="<%= root_path %>" class="logo">
    <span style="font-size: 1.8rem;">ğŸ§µ</span>
    <div class="logo-text">Les Tisserands<% if I18n.locale != :fr %> <span class="logo-translation">(<%= t('hero.brand_translation', default: 'The Weavers') %>)</span><% end %></div>
  </a>

  <div class="nav-links nav-desktop">
    <a href="<%= root_path %>" class="<%= 'active-link' if active == 'home' %>"><%= t('navbar.home') %></a>
    <a href="<%= philosophie_path %>" class="<%= 'active-link' if active == 'philosophie' %>"><%= t('navbar.principles') %></a>
    <a href="<%= contributions_path %>" class="<%= 'active-link' if active == 'contributions' %>"><%= t('navbar.contributions') %></a>
    <a href="<%= portraits_path %>" class="<%= 'active-link' if active == 'temoignages' %>"><%= t('navbar.testimonials') %></a>
    <a href="<%= assistant_juridique_path %>" class="btn-assistant <%= 'active-link' if active == 'assistant' %>">ğŸ¤ <%= t('navbar.legal_assistant') %></a>
    <a href="<%= new_contribution_path %>" class="btn-contribute">ï¼‹ <%= t('navbar.share', default: 'Partager') %></a>
    <div class="lang-switcher">
      <button class="lang-switcher-btn" id="langBtn" aria-label="Language">
        ğŸŒ <%= t('language_name') %> â–¾
      </button>
      <div class="lang-dropdown" id="langDropdown">
        <a href="<%= url_for(locale: :fr) %>" class="<%= 'current-lang' if I18n.locale == :fr %>">ğŸ‡«ğŸ‡· FranÃ§ais</a>
        <a href="<%= url_for(locale: :en) %>" class="<%= 'current-lang' if I18n.locale == :en %>">ğŸ‡¬ğŸ‡§ English</a>
        <a href="<%= url_for(locale: :ar) %>" class="<%= 'current-lang' if I18n.locale == :ar %>">ğŸ‡¸ğŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</a>
        <a href="<%= url_for(locale: :uk) %>" class="<%= 'current-lang' if I18n.locale == :uk %>">ğŸ‡ºğŸ‡¦ Ğ£ĞºÑ€Ğ°Ñ—Ğ½ÑÑŒĞºĞ°</a>
        <a href="<%= url_for(locale: :prs) %>" class="<%= 'current-lang' if I18n.locale == :prs %>">ğŸ‡¦ğŸ‡« Ø¯Ø±ÛŒ</a>
        <a href="<%= url_for(locale: :es) %>" class="<%= 'current-lang' if I18n.locale == :es %>">ğŸ‡ªğŸ‡¸ EspaÃ±ol</a>
        <a href="<%= url_for(locale: :de) %>" class="<%= 'current-lang' if I18n.locale == :de %>">ğŸ‡©ğŸ‡ª Deutsch</a>
      </div>
    </div>
  </div>

  <button class="burger-btn" id="burgerBtn" aria-label="Menu">
    <span></span>
    <span></span>
    <span></span>
  </button>
</nav>

<div class="mobile-menu" id="mobileMenu">
  <a href="<%= root_path %>"><%= t('navbar.mobile_home') %></a>
  <a href="<%= philosophie_path %>"><%= t('navbar.mobile_principles') %></a>
  <a href="<%= contributions_path %>"><%= t('navbar.mobile_contributions') %></a>
  <a href="<%= portraits_path %>"><%= t('navbar.mobile_testimonials') %></a>
  <a href="<%= assistant_juridique_path %>" class="mobile-assistant">ğŸ¤ <%= t('navbar.legal_assistant') %></a>
  <a href="<%= new_contribution_path %>" class="mobile-cta">ï¼‹ <%= t('navbar.share', default: 'Partager') %></a>
  <div class="mobile-lang-flags">
    <a href="<%= url_for(locale: :fr) %>" class="<%= 'active' if I18n.locale == :fr %>">ğŸ‡«ğŸ‡·</a>
    <a href="<%= url_for(locale: :en) %>" class="<%= 'active' if I18n.locale == :en %>">ğŸ‡¬ğŸ‡§</a>
    <a href="<%= url_for(locale: :ar) %>" class="<%= 'active' if I18n.locale == :ar %>">ğŸ‡¸ğŸ‡¦</a>
    <a href="<%= url_for(locale: :uk) %>" class="<%= 'active' if I18n.locale == :uk %>">ğŸ‡ºğŸ‡¦</a>
    <a href="<%= url_for(locale: :prs) %>" class="<%= 'active' if I18n.locale == :prs %>">ğŸ‡¦ğŸ‡«</a>
    <a href="<%= url_for(locale: :es) %>" class="<%= 'active' if I18n.locale == :es %>">ğŸ‡ªğŸ‡¸</a>
    <a href="<%= url_for(locale: :de) %>" class="<%= 'active' if I18n.locale == :de %>">ğŸ‡©ğŸ‡ª</a>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const burger = document.getElementById('burgerBtn');
    const mobile = document.getElementById('mobileMenu');
    if (!burger || burger.dataset.bound) return;
    burger.dataset.bound = 'true';

    burger.addEventListener('click', () => {
      burger.classList.toggle('active');
      mobile.classList.toggle('active');
      document.body.style.overflow = mobile.classList.contains('active') ? 'hidden' : '';
    });

    mobile.querySelectorAll('a').forEach(link => {
      link.addEventListener('click', () => {
        burger.classList.remove('active');
        mobile.classList.remove('active');
        document.body.style.overflow = '';
      });
    });

    const langBtn = document.getElementById('langBtn');
    const langDrop = document.getElementById('langDropdown');
    if (langBtn && langDrop) {
      langBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        langDrop.classList.toggle('open');
      });
      document.addEventListener('click', () => langDrop.classList.remove('open'));
    }
  });
</script>
